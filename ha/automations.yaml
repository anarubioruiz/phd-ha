- trigger:
  - platform: state
    entity_id: switch.virtual_occupancy
    to: 'on'
  - platform: state
    entity_id: switch.virtual_occupancy
    to: 'off'
  action:
  - service: virtual.turn_{{ trigger.to_state.state }}
    target:
      entity_id: binary_sensor.virtual_is_occupied

- trigger:
  - platform: state
    entity_id: binary_sensor.virtual_is_occupied
    to: 'on'
  action:
  - service: cover.open_cover
    target:
      entity_id: cover.virtual_cover

- trigger:
  - platform: state
    entity_id: binary_sensor.virtual_is_occupied
    to: 'off'
  action:
  - service: cover.close_cover
    target:
      entity_id: cover.virtual_cover
